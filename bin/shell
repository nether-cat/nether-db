#!/usr/bin/env node

const XLSX = require('xlsx');
const db = require('../models');

let models = Object.values(db.sequelize.models)
  .filter(model => model.name.indexOf('_record') !== -1);

let args = process.argv.slice(2);
let workbook = XLSX.readFile(args[0]);
let sheet, sheetTitle;
let sheetNotFound = function () {
  throw new Error('Sheet with records not found!');
};
try {
  sheet = workbook.Sheets['Varves'];
  sheetTitle = sheet['B2'].v.trim().toLowerCase();
} catch (e) {
  sheetNotFound();
} finally {
  if ('varve template' !== sheetTitle) sheetNotFound();
}
let json = XLSX.utils.sheet_to_json(sheet, {header: 'A'});
let columnHeader = json.find(row => row.__rowNum__ === 7);

console.log('Done!');
